generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Users {
  id                Int       @id @default(autoincrement())
  name              String
  intro             String?
  profile_image_url String?
  role              Role      @default(USER)
  created_at        DateTime  @default(now())
  updated_at        DateTime? @updatedAt
  email             String    @unique
  travels           Travels[]

  @@map("users")
}

model Travels {
  id            Int            @id @default(autoincrement())
  start_date    DateTime
  end_date      DateTime
  title         String
  content       String?        @db.VarChar(280)
  created_at    DateTime       @default(now())
  updated_at    DateTime?      @updatedAt
  user_id       Int
  country_code  String         @db.VarChar(2)
  city_id       Int?
  etc_city_name String?
  magnet_id     Int
  images        TravelImages[]
  city          Cities?        @relation(fields: [city_id], references: [id])
  country       Countries      @relation(fields: [country_code], references: [code])
  magnet        Magnets        @relation(fields: [magnet_id], references: [id])
  author        Users          @relation(fields: [user_id], references: [id])

  @@map("travels")
}

model TravelImages {
  id         Int      @id @default(autoincrement())
  sequence   Int
  url        String
  created_at DateTime @default(now())
  travel_id  Int
  travel     Travels  @relation(fields: [travel_id], references: [id], onDelete: Cascade)

  @@map("travel_images")
}

model Countries {
  id         Int       @id @default(autoincrement())
  code       String    @unique
  name       String    @unique
  continent  String
  created_at DateTime  @default(now())
  updated_at DateTime  @updatedAt
  name_kr    String
  cities     Cities[]
  magnets    Magnets[]
  travels    Travels[]

  @@map("countries")
}

model Cities {
  id           Int       @id @default(autoincrement())
  name         String
  name_kr      String?
  latitude     String?
  longitude    String?
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
  country_code String
  country      Countries @relation(fields: [country_code], references: [code])
  Magnet       Magnets[]
  travels      Travels[]

  @@map("cities")
}

model Magnets {
  id           Int        @id @default(autoincrement())
  url          String     @unique
  name         String
  type         MagnetType
  created_at   DateTime   @default(now())
  updated_at   DateTime   @updatedAt
  country_code String?    @db.VarChar(2)
  city_id      Int?
  city         Cities?    @relation(fields: [city_id], references: [id], onDelete: Cascade)
  country      Countries? @relation(fields: [country_code], references: [code], onDelete: Cascade)
  travels      Travels[]

  @@map("magnets")
}

enum Role {
  USER
  ADMIN

  @@map("user_role")
}

enum MagnetType {
  SPECIAL_CITY
  COUNTRY
  LOGO

  @@map("magnet_type")
}
